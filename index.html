<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–Ω–∫–µ—Ç–∞ –∑–∞—ë–º—â–∏–∫–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .form-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .form-header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .form-header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .form-header p {
            opacity: 0.9;
            font-size: 16px;
        }

        .form-body {
            padding: 30px;
        }

        .form-section {
            margin-bottom: 30px;
            padding: 25px;
            border: 1px solid #e1e8ed;
            border-radius: 10px;
            background: #fafbfc;
        }

        .section-title {
            font-size: 18px;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
            display: flex;
            align-items: center;
        }

        .section-title::before {
            content: "‚ñ∏";
            margin-right: 10px;
            color: #3498db;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 15px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
            font-size: 14px;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: white;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .checkbox-group input {
            width: auto;
        }

        .dynamic-section {
            background: white;
            border: 2px dashed #bdc3c7;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
        }

        .dynamic-item {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            position: relative;
        }

        .remove-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s ease;
        }

        .remove-btn:hover {
            background: #c0392b;
        }

        .add-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: background 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .add-btn::before {
            content: "+";
            font-size: 18px;
        }

        .add-btn:hover {
            background: #219a52;
        }

        .submit-btn {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: transform 0.3s ease;
            display: block;
            margin: 30px auto 0;
            min-width: 200px;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(52, 152, 219, 0.3);
        }

        .required::after {
            content: " *";
            color: #e74c3c;
        }

        .calculated-totals {
            background: #e8f4fd;
            border: 1px solid #3498db;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
        }

        .total-item {
            margin: 5px 15px;
            font-weight: 600;
            color: #2c3e50;
        }

        .total-value {
            color: #3498db;
            font-weight: 700;
        }

        .download-btn {
            background: linear-gradient(135deg, #27ae60 0%, #219a52 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: transform 0.3s ease;
            display: block;
            margin: 20px auto 0;
            min-width: 250px;
            text-align: center;
            text-decoration: none;
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(39, 174, 96, 0.3);
        }

        .download-btn.hidden {
            display: none;
        }

        .success-message {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
            color: #155724;
            display: none;
        }

        .error-message {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
            color: #721c24;
            display: none;
        }

        .debug-info {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
            display: none;
        }

        .other-input {
            margin-top: 10px;
            display: none;
        }

        .business-type-select {
            margin-top: 10px;
            display: none;
        }

        .business-activity-checkbox {
            margin-top: 10px;
            display: none;
        }

        .property-subsection {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f5f7fa;
        }

        .property-subtitle {
            font-size: 16px;
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid #3498db;
        }

        .checkbox-row {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .overdue-date-input {
            margin-top: 10px;
            display: none;
        }

        .transactions-section {
            display: none;
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .form-body {
                padding: 20px;
            }
            
            .form-section {
                padding: 15px;
            }
            
            .calculated-totals {
                flex-direction: column;
            }
            
            .checkbox-row {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="form-container">
        <div class="form-header">
            <h1>üìä –ê–Ω–∫–µ—Ç–∞ –∑–∞—ë–º—â–∏–∫–∞</h1>
            <p>–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è –∑–∞—è–≤–∫–∏</p>
        </div>

        <form id="loanForm" class="form-body">
            <!-- –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ -->
            <div class="form-section">
                <h3 class="section-title">üìã –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞</h3>
                <div id="liabilityItems">
                    <div class="dynamic-item">
                        <button type="button" class="remove-btn">√ó</button>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>–í–∏–¥ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞</label>
                                <select name="liabilities[0][name]" onchange="toggleLiabilityOtherInput(this)">
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≤–∏–¥ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞</option>
                                    <option value="–ú–§–û">–ú–§–û</option>
                                    <option value="–ê–≤—Ç–æ–∫—Ä–µ–¥–∏—Ç">–ê–≤—Ç–æ–∫—Ä–µ–¥–∏—Ç</option>
                                    <option value="–ò–ø–æ—Ç–µ–∫–∞">–ò–ø–æ—Ç–µ–∫–∞</option>
                                    <option value="–ö—Ä–µ–¥–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞">–ö—Ä–µ–¥–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞</option>
                                    <option value="–£—â–µ—Ä–±">–£—â–µ—Ä–±</option>
                                    <option value="other">–î—Ä—É–≥–æ–µ</option>
                                </select>
                                <input type="text" name="liabilities[0][other_name]" placeholder="–£–∫–∞–∂–∏—Ç–µ –≤–∏–¥ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞" class="other-input">
                            </div>
                            <!-- –ù–û–í–û–ï –ü–û–õ–ï: –ë–∞–Ω–∫ –≤—ã–¥–∞–≤—à–∏–π –∫—Ä–µ–¥–∏—Ç -->
                            <div class="form-group">
                                <label>–ë–∞–Ω–∫ –≤—ã–¥–∞–≤—à–∏–π –∫—Ä–µ–¥–∏—Ç</label>
                                <input type="text" name="liabilities[0][bank_name]" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –±–∞–Ω–∫–∞">
                            </div>
                            <div class="form-group">
                                <label>–ï–∂–µ–º–µ—Å—è—á–Ω—ã–π –ø–ª–∞—Ç–µ–∂</label>
                                <input type="number" name="liabilities[0][monthly_payment]" placeholder="0" class="monthly-payment-input">
                            </div>
                            <div class="form-group">
                                <label>–û–±—â–∞—è —Å—É–º–º–∞</label>
                                <input type="number" name="liabilities[0][total_liability]" placeholder="0" class="total-liability-input">
                            </div>
                            <!-- –ù–æ–≤—ã–µ –ø–æ–ª—è –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤ -->
                            <div class="form-group">
                                <label>–î–∞—Ç–∞ –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∏—è –∫—Ä–µ–¥–∏—Ç–∞</label>
                                <input type="text" name="liabilities[0][loan_date]" placeholder="–î–î.–ú–ú.–ì–ì–ì–ì">
                            </div>
                            <div class="form-group">
                                <label>–°—Ä–æ–∫ –∫—Ä–µ–¥–∏—Ç–∞ (–ª–µ—Ç)</label>
                                <input type="number" name="liabilities[0][loan_term]" placeholder="0" step="0.1" min="0">
                            </div>
                            <div class="form-group">
                                <label>–°—É–º–º–∞ –≤–Ω–µ—Å–µ–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π</label>
                                <input type="number" name="liabilities[0][paid_amount]" placeholder="0">
                            </div>
                            <div class="form-group">
                                <label class="checkbox-group">
                                    <input type="checkbox" name="liabilities[0][has_overdues]" onchange="toggleOverdueDateInput(this)">
                                    –ò–º–µ—é—Ç—Å—è –ª–∏ –ø—Ä–æ—Å—Ä–æ—á–∫–∏
                                </label>
                                <input type="text" name="liabilities[0][overdue_date]" placeholder="–î–î.–ú–ú.–ì–ì–ì–ì" class="overdue-date-input">
                            </div>
                            <div class="form-group">
                                <label class="checkbox-group">
                                    <input type="checkbox" name="liabilities[0][has_guarantor]">
                                    –ï—Å—Ç—å-–ª–∏ –ø–æ—Ä—É—á–∏—Ç–µ–ª—å
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <button type="button" class="add-btn" onclick="addLiabilityItem()">–î–æ–±–∞–≤–∏—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ</button>
                
                <!-- –ë–ª–æ–∫ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–º–∏ —Å—É–º–º–∞–º–∏ -->
                <div class="calculated-totals">
                    <div class="total-item">
                        –û–±—â–∞—è —Å—É–º–º–∞ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤: <span id="totalLiabilities" class="total-value">0</span> —Ä—É–±.
                    </div>
                    <div class="total-item">
                        –û–±—â–∏–π –µ–∂–µ–º–µ—Å—è—á–Ω—ã–π –ø–ª–∞—Ç–µ–∂: <span id="totalMonthlyPayment" class="total-value">0</span> —Ä—É–±.
                    </div>
                </div>
            </div>

            <!-- ID —Å–¥–µ–ª–∫–∏ -->
            <div class="form-section">
                <h3 class="section-title">üîó ID —Å–¥–µ–ª–∫–∏</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label class="required">ID —Å–¥–µ–ª–∫–∏</label>
                        <input type="text" name="deal_id" placeholder="–í–≤–µ–¥–∏—Ç–µ ID —Å–¥–µ–ª–∫–∏" required>
                    </div>
                </div>
            </div>

            <!-- –õ–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
            <div class="form-section">
                <h3 class="section-title">üë§ –õ–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label class="required">–§–∞–º–∏–ª–∏—è</label>
                        <input type="text" name="last_name" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ñ–∞–º–∏–ª–∏—é" required>
                    </div>
                    <div class="form-group">
                        <label class="required">–ò–º—è</label>
                        <input type="text" name="first_name" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è" required>
                    </div>
                    <div class="form-group">
                        <label>–û—Ç—á–µ—Å—Ç–≤–æ</label>
                        <input type="text" name="middle_name" placeholder="–í–≤–µ–¥–∏—Ç–µ –æ—Ç—á–µ—Å—Ç–≤–æ">
                    </div>
                </div>
                <div class="form-grid">
                    <div class="form-group">
                        <label class="required">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</label>
                        <input type="text" name="birth_date" placeholder="–î–î.–ú–ú.–ì–ì–ì–ì" required>
                    </div>
                    <div class="form-group">
                        <label class="required">–†–µ–≥–∏–æ–Ω –∏ –≥–æ—Ä–æ–¥ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è</label>
                        <input type="text" name="location" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ä–µ–≥–∏–æ–Ω –∏ –≥–æ—Ä–æ–¥" required>
                    </div>
                </div>
                <div class="form-grid">
                    <div class="form-group">
                        <label class="required">–°–µ–º–µ–π–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ</label>
                        <select name="marital_status" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ–º–µ–π–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ</option>
                            <option value="married">–ñ–µ–Ω–∞—Ç/–ó–∞–º—É–∂–µ–º</option>
                            <option value="single">–•–æ–ª–æ—Å—Ç/–ù–µ –∑–∞–º—É–∂–µ–º</option>
                            <option value="divorced">–†–∞–∑–≤–µ–¥–µ–Ω(–∞)</option>
                            <option value="widowed">–í–¥–æ–≤–µ—Ü/–í–¥–æ–≤–∞</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="required">–ü–æ–ª</label>
                        <select name="gender" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª</option>
                            <option value="male">–ú—É–∂—Å–∫–æ–π</option>
                            <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- –î–µ—Ç–∏ –Ω–∞ –∏–∂–¥–∏–≤–µ–Ω–∏–∏ -->
            <div class="form-section">
                <h3 class="section-title">üë∂ –î–µ—Ç–∏ –Ω–∞ –∏–∂–¥–∏–≤–µ–Ω–∏–∏</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>–î–µ—Ç–∏ –¥–æ 18 –ª–µ—Ç</label>
                        <input type="number" name="dependents_children" placeholder="0" min="0" max="20">
                    </div>
                </div>
            </div>

            <!-- –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–æ—Ö–æ–¥–∞ -->
            <div class="form-section">
                <h3 class="section-title">üíº –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–æ—Ö–æ–¥–∞</h3>
                <div id="incomeItems">
                    <div class="dynamic-item">
                        <button type="button" class="remove-btn">√ó</button>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–æ—Ö–æ–¥–∞</label>
                                <select name="income[0][name]" onchange="toggleIncomeOtherInput(this)">
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–æ—Ö–æ–¥–∞</option>
                                    <option value="–ó–ü">–ó–∞—Ä–ø–ª–∞—Ç–∞</option>
                                    <option value="–ü–æ—Å–æ–±–∏–µ">–ü–æ—Å–æ–±–∏–µ</option>
                                    <option value="–ü–µ–Ω—Å–∏—è">–ü–µ–Ω—Å–∏—è</option>
                                    <option value="–ù–µ–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥">–ù–µ–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥</option>
                                    <option value="–ê–ª–∏–º–µ–Ω—Ç—ã">–ê–ª–∏–º–µ–Ω—Ç—ã</option>
                                    <option value="other">–î—Ä—É–≥–æ–µ</option>
                                </select>
                                <input type="text" name="income[0][other_name]" placeholder="–£–∫–∞–∂–∏—Ç–µ –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–æ—Ö–æ–¥–∞" class="other-input">
                            </div>
                            <div class="form-group">
                                <label>–°—É–º–º–∞ –≤ –º–µ—Å—è—Ü</label>
                                <input type="number" name="income[0][salary]" placeholder="0">
                            </div>
                            <!-- –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–π —á–µ–∫–±–æ–∫—Å "—É–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è-–ª–∏" -->
                            <div class="form-group">
                                <label class="checkbox-group">
                                    <input type="checkbox" name="income[0][is_withheld]">
                                    –£–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è-–ª–∏
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <button type="button" class="add-btn" onclick="addIncomeItem()">–î–æ–±–∞–≤–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–æ—Ö–æ–¥–∞</button>
            </div>

            <!-- –ú–µ—Å—è—á–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã -->
            <div class="form-section">
                <h3 class="section-title">üìÖ –ï–∂–µ–º–µ—Å—è—á–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>–ê—Ä–µ–Ω–¥–∞ –∂–∏–ª—å—è</label>
                        <input type="number" name="house_expenses" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>–ó–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç—ã</label>
                        <input type="number" name="food_expenses" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã</label>
                        <input type="number" name="transport_expenses" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>–ó–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –º–µ–¥–∏—Ü–∏–Ω—É</label>
                        <input type="number" name="medical_expenses" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>–ó–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –º–æ–±–∏–ª—å–Ω—É—é —Å–≤—è–∑—å</label>
                        <input type="number" name="mobile_expenses" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –¥–µ—Ç–µ–π</label>
                        <input type="number" name="children_expenses" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>–ê–ª–∏–º–µ–Ω—Ç—ã</label>
                        <input type="number" name="alimony_expenses" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>–£–¥–µ—Ä–∂–∞–Ω–∏—è –æ—Ç –§–°–°–ü</label>
                        <input type="number" name="fsp_expenses" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>–ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏</label>
                        <input type="number" name="utilities_expenses" placeholder="0">
                    </div>
                </div>
            </div>

            <!-- –ò–º—É—â–µ—Å—Ç–≤–æ -->
            <div class="form-section">
                <h3 class="section-title">üè† –ò–º—É—â–µ—Å—Ç–≤–æ –∑–∞—ë–º—â–∏–∫–∞</h3>
                
                <!-- –ù–µ–¥–≤–∏–∂–∏–º–æ–µ –∏–º—É—â–µ—Å—Ç–≤–æ -->
                <div class="property-subsection">
                    <h4 class="property-subtitle">–ù–µ–¥–≤–∏–∂–∏–º–æ–µ –∏–º—É—â–µ—Å—Ç–≤–æ</h4>
                    <div id="realEstateItems">
                        <div class="dynamic-item">
                            <button type="button" class="remove-btn">√ó</button>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∏–º—É—â–µ—Å—Ç–≤–∞</label>
                                    <select name="real_estate[0][name]" onchange="toggleRealEstateOtherInput(this)">
                                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≤–∏–¥ –∏–º—É—â–µ—Å—Ç–≤–∞</option>
                                        <option value="–ö–≤–∞—Ä—Ç–∏—Ä–∞">–ö–≤–∞—Ä—Ç–∏—Ä–∞</option>
                                        <option value="–î–æ–º">–î–æ–º</option>
                                        <option value="–î–∞—á–∞">–î–∞—á–∞</option>
                                        <option value="–ê–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã">–ê–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã</option>
                                        <option value="–ó–µ–º–µ–ª—å–Ω—ã–π —É—á–∞—Å—Ç–æ–∫">–ó–µ–º–µ–ª—å–Ω—ã–π —É—á–∞—Å—Ç–æ–∫</option>
                                        <option value="–ö–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å">–ö–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å</option>
                                        <option value="other">–î—Ä—É–≥–æ–µ</option>
                                    </select>
                                    <input type="text" name="real_estate[0][other_name]" placeholder="–£–∫–∞–∂–∏—Ç–µ –≤–∏–¥ –∏–º—É—â–µ—Å—Ç–≤–∞" class="other-input">
                                </div>
                                <div class="form-group">
                                    <label>–°—Ç–æ–∏–º–æ—Å—Ç—å</label>
                                    <input type="number" name="real_estate[0][cost]" placeholder="0">
                                </div>
                                <div class="form-group">
                                    <label>–î–æ–ª—è –≤–ª–∞–¥–µ–Ω–∏—è</label>
                                    <select name="real_estate[0][ownership_share]">
                                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–ª—é –≤–ª–∞–¥–µ–Ω–∏—è</option>
                                        <option value="100%">100%</option>
                                        <option value="1/2">1/2</option>
                                        <option value="1/3">1/3</option>
                                        <option value="1/4">1/4</option>
                                        <option value="1/5">1/5</option>
                                        <option value="1/6">1/6</option>
                                        <option value="1/7">1/7</option>
                                        <option value="1/8">1/8</option>
                                        <option value="1/9">1/9</option>
                                        <option value="1/10">1/10</option>
                                    </select>
                                </div>
                                <!-- –ß–µ–∫–±–æ–∫—Å—ã –Ω–∞ –æ–¥–Ω–æ–º —É—Ä–æ–≤–Ω–µ -->
                                <div class="form-group">
                                    <div class="checkbox-row">
                                        <label class="checkbox-group">
                                            <input type="checkbox" name="real_estate[0][is_jointly]">
                                            –°–æ–≤–º–µ—Å—Ç–Ω–æ –Ω–∞–∂–∏—Ç–æ–µ
                                        </label>
                                        <label class="checkbox-group">
                                            <input type="checkbox" name="real_estate[0][is_pledged]">
                                            –í –∑–∞–ª–æ–≥–µ
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="add-btn" onclick="addRealEstateItem()">–î–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–≤–∏–∂–∏–º–æ–µ –∏–º—É—â–µ—Å—Ç–≤–æ</button>
                </div>
                
                <!-- –î–≤–∏–∂–∏–º–æ–µ –∏–º—É—â–µ—Å—Ç–≤–æ -->
                <div class="property-subsection">
                    <h4 class="property-subtitle">–î–≤–∏–∂–∏–º–æ–µ –∏–º—É—â–µ—Å—Ç–≤–æ</h4>
                    <div id="movableItems">
                        <div class="dynamic-item">
                            <button type="button" class="remove-btn">√ó</button>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label>–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∏–º—É—â–µ—Å—Ç–≤–∞</label>
                                    <select name="movable[0][name]" onchange="toggleMovableOtherInput(this)">
                                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≤–∏–¥ –∏–º—É—â–µ—Å—Ç–≤–∞</option>
                                        <option value="–ê–≤—Ç–æ–º–æ–±–∏–ª—å">–ê–≤—Ç–æ–º–æ–±–∏–ª—å</option>
                                        <option value="–ê–≤—Ç–æ–±—É—Å">–ê–≤—Ç–æ–±—É—Å</option>
                                        <option value="–ú–æ—Ç–æ—Ü–∏–∫–ª">–ú–æ—Ç–æ—Ü–∏–∫–ª</option>
                                        <option value="–ü—Ä–∏—Ü–µ–ø">–ü—Ä–∏—Ü–µ–ø</option>
                                        <option value="–°–Ω–µ–≥–æ—Ö–æ–¥">–°–Ω–µ–≥–æ—Ö–æ–¥</option>
                                        <option value="–°–ø–µ—Ü—Ç–µ—Ö–Ω–∏–∫–∞">–°–ø–µ—Ü—Ç–µ—Ö–Ω–∏–∫–∞</option>
                                        <option value="–¢—Ä–∞–∫—Ç–æ—Ä">–¢—Ä–∞–∫—Ç–æ—Ä</option>
                                        <option value="–ö–∞—Ç–µ—Ä (–ª–æ–¥–∫–∞)">–ö–∞—Ç–µ—Ä (–ª–æ–¥–∫–∞)</option>
                                        <option value="–í–∞–≥–æ–Ω—á–∏–∫">–í–∞–≥–æ–Ω—á–∏–∫</option>
                                        <option value="other">–î—Ä—É–≥–æ–µ</option>
                                    </select>
                                    <input type="text" name="movable[0][other_name]" placeholder="–£–∫–∞–∂–∏—Ç–µ –≤–∏–¥ –∏–º—É—â–µ—Å—Ç–≤–∞" class="other-input">
                                </div>
                                <div class="form-group">
                                    <label>–°—Ç–æ–∏–º–æ—Å—Ç—å</label>
                                    <input type="number" name="movable[0][cost]" placeholder="0">
                                </div>
                                <div class="form-group">
                                    <div class="checkbox-row">
                                        <label class="checkbox-group">
                                            <input type="checkbox" name="movable[0][is_jointly]">
                                            –°–æ–≤–º–µ—Å—Ç–Ω–æ –Ω–∞–∂–∏—Ç–æ–µ
                                        </label>
                                        <label class="checkbox-group">
                                            <input type="checkbox" name="movable[0][is_pledged]">
                                            –í –∑–∞–ª–æ–≥–µ
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="add-btn" onclick="addMovableItem()">–î–æ–±–∞–≤–∏—Ç—å –¥–≤–∏–∂–∏–º–æ–µ –∏–º—É—â–µ—Å—Ç–≤–æ</button>
                </div>
            </div>

            <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
            <div class="form-section">
                <h3 class="section-title">üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label class="checkbox-group">
                            <input type="checkbox" name="is_co_borrower">
                            –Ø–≤–ª—è–µ—Ç—Å—è –ª–∏ –∫–ª–∏–µ–Ω—Ç —Å–æ–∑–∞—ë–º—â–∏–∫–æ–º –ø–æ –∏–ø–æ—Ç–µ—á–Ω–æ–º—É –∫—Ä–µ–¥–∏—Ç—É
                        </label>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-group">
                            <input type="checkbox" name="has_transactions" id="hasTransactions">
                            –°–æ–≤–µ—Ä—à–∞–ª–∏—Å—å –ª–∏ —Å–¥–µ–ª–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –≥–æ–¥–∞
                        </label>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-group">
                            <input type="checkbox" name="has_overdues">
                            –ë—ã–ª–∏ –ª–∏ –ø—Ä–æ—Å—Ä–æ—á–∫–∏ –ø–æ –∫—Ä–µ–¥–∏—Ç—É –Ω–∞ –º–æ–º–µ–Ω—Ç —Å–æ–≤–µ—Ä—à–µ–Ω–∏—è —Å–¥–µ–ª–∫–∏
                        </label>
                    </div>
                    <!-- –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–π —á–µ–∫–±–æ–∫—Å –∏ –ø–æ–ª–µ –≤—ã–±–æ—Ä–∞ -->
                    <div class="form-group">
                        <label class="checkbox-group">
                            <input type="checkbox" name="is_business_owner" id="isBusinessOwner">
                            –Ø–≤–ª—è–µ—Ç—Å—è –ò–ü –∏–ª–∏ –û–û–û
                        </label>
                        <div class="business-type-select" id="businessTypeSelect">
                            <label>–¢–∏–ø –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏</label>
                            <select name="business_type">
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏</option>
                                <option value="–ò–ü">–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å (–ò–ü)</option>
                                <option value="–û–û–û">–û–±—â–µ—Å—Ç–≤–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é (–û–û–û)</option>
                            </select>
                        </div>
                        <div class="business-activity-checkbox" id="businessActivityCheckbox">
                            <label class="checkbox-group">
                                <input type="checkbox" name="is_business_active">
                                –í–µ–¥—ë—Ç –ª–∏ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–µ–π—á–∞—Å
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ù–û–í–´–ô –†–ê–ó–î–ï–õ: –°–¥–µ–ª–∫–∏ –∑–∞—ë–º—â–∏–∫–∞ -->
            <div id="transactionsSection" class="form-section transactions-section">
                <h3 class="section-title">üìä –°–¥–µ–ª–∫–∏ –∑–∞—ë–º—â–∏–∫–∞</h3>
                <div id="transactionItems">
                    <div class="dynamic-item">
                        <button type="button" class="remove-btn">√ó</button>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>–í–∏–¥ —Å–¥–µ–ª–∫–∏</label>
                                <select name="transactions[0][type]" onchange="toggleTransactionTypeOtherInput(this)">
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≤–∏–¥ —Å–¥–µ–ª–∫–∏</option>
                                    <option value="–ü—Ä–æ–¥–∞–∂–∞">–ü—Ä–æ–¥–∞–∂–∞</option>
                                    <option value="–î–∞—Ä–µ–Ω–∏–µ">–î–∞—Ä–µ–Ω–∏–µ</option>
                                    <option value="other">–î—Ä—É–≥–æ–µ</option>
                                </select>
                                <input type="text" name="transactions[0][other_type]" placeholder="–£–∫–∞–∂–∏—Ç–µ –≤–∏–¥ —Å–¥–µ–ª–∫–∏" class="other-input">
                            </div>
                            <div class="form-group">
                                <label>–ß—Ç–æ –ø—Ä–æ–¥–∞–ª</label>
                                <select name="transactions[0][item]" onchange="toggleTransactionItemOtherInput(this)">
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –æ–±—ä–µ–∫—Ç —Å–¥–µ–ª–∫–∏</option>
                                    <option value="–ö–≤–∞—Ä—Ç–∏—Ä–∞">–ö–≤–∞—Ä—Ç–∏—Ä–∞</option>
                                    <option value="–ú–∞—à–∏–Ω–∞">–ú–∞—à–∏–Ω–∞</option>
                                    <option value="other">–î—Ä—É–≥–æ–µ</option>
                                </select>
                                <input type="text" name="transactions[0][other_item]" placeholder="–£–∫–∞–∂–∏—Ç–µ –æ–±—ä–µ–∫—Ç —Å–¥–µ–ª–∫–∏" class="other-input">
                            </div>
                            <div class="form-group">
                                <label>–ó–∞ —Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–¥–∞–ª</label>
                                <input type="number" name="transactions[0][amount]" placeholder="0">
                            </div>
                            <div class="form-group">
                                <label>–î–∞—Ç–∞ —Å–¥–µ–ª–∫–∏</label>
                                <input type="text" name="transactions[0][date]" placeholder="–î–î.–ú–ú.–ì–ì–ì–ì">
                            </div>
                        </div>
                    </div>
                </div>
                <button type="button" class="add-btn" onclick="addTransactionItem()">–î–æ–±–∞–≤–∏—Ç—å —Å–¥–µ–ª–∫—É</button>
            </div>

            <button type="submit" class="submit-btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
            
            <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–µ -->
            <div id="successMessage" class="success-message">
                <h3>‚úÖ –ó–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!</h3>
                <p>–í–∞—à–∞ –∞–Ω–∫–µ—Ç–∞ –±—ã–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞. –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ —Å–∫–∞—á–∞—Ç—å PDF-–≤–µ—Ä—Å–∏—é –≤–∞—à–µ–π –∞–Ω–∫–µ—Ç—ã.</p>
            </div>

            <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ -->
            <div id="errorMessage" class="error-message">
                <h3>‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏</h3>
                <p id="errorText">–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –¥–∞–Ω–Ω—ã—Ö.</p>
            </div>

            <!-- –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
            <div id="debugInfo" class="debug-info"></div>
            
            <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è PDF -->
            <a id="downloadPdf" class="download-btn hidden" download="–∞–Ω–∫–µ—Ç–∞_–∑–∞–µ–º—â–∏–∫–∞.pdf">
                üìÑ –°–∫–∞—á–∞—Ç—å –∞–Ω–∫–µ—Ç—É –≤ PDF
            </a>
        </form>
    </div>

    <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@pdf-lib/fontkit/dist/fontkit.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="script.js"></script>
    <script src="pdfEdit.js"></script>
    <script src="page_2_handler.js"></script>
    <script src="bitrix_worker.js"></script>
    <script>
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è –ø–æ–ª—è –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
        document.getElementById('isBusinessOwner').addEventListener('change', function() {
            const businessTypeSelect = document.getElementById('businessTypeSelect');
            const businessActivityCheckbox = document.getElementById('businessActivityCheckbox');
            
            if (this.checked) {
                businessTypeSelect.style.display = 'block';
                businessActivityCheckbox.style.display = 'block';
            } else {
                businessTypeSelect.style.display = 'none';
                businessActivityCheckbox.style.display = 'none';
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ —Å–∫—Ä—ã—Ç–∏–∏
                document.querySelector('select[name="business_type"]').value = '';
                document.querySelector('input[name="is_business_active"]').checked = false;
            }
        });

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è —Ä–∞–∑–¥–µ–ª–∞ —Å–¥–µ–ª–æ–∫
        document.getElementById('hasTransactions').addEventListener('change', function() {
            const transactionsSection = document.getElementById('transactionsSection');
            
            if (this.checked) {
                transactionsSection.style.display = 'block';
            } else {
                transactionsSection.style.display = 'none';
                // –û—á–∏—â–∞–µ–º –≤—Å–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —Å–¥–µ–ª–∫–∏ –ø—Ä–∏ —Å–∫—Ä—ã—Ç–∏–∏ —Ä–∞–∑–¥–µ–ª–∞
                const transactionItems = document.getElementById('transactionItems');
                while (transactionItems.children.length > 1) {
                    transactionItems.removeChild(transactionItems.lastChild);
                }
            }
        });

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∫–Ω–æ–ø–æ–∫ —É–¥–∞–ª–µ–Ω–∏—è
        function updateRemoveButtons() {
            document.querySelectorAll('.remove-btn').forEach(btn => {
                btn.onclick = function() {
                    this.parentElement.remove();
                    updateRemoveButtons();
                    updateLiabilitiesTotals();
                };
            });
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            updateRemoveButtons();
        });
    </script>
</body>
</html>
